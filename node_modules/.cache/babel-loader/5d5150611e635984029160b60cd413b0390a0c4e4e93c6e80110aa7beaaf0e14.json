{"ast":null,"code":"import axios from 'axios';\nexport default class BaseHttpService {\n  constructor(routerStore) {\n    this.BASE_URL = process.env.REACT_APP_BASE_URL || 'http://localhost:3000';\n    this._accessToken = null;\n    this.routerStore = routerStore;\n  }\n  async get(endpoint, options = {}) {\n    Object.assign(options, this._getCommonOptions());\n    return axios.get(`${this.BASE_URL}/${endpoint}`, options).catch(error => this._handleHttpError(error));\n  }\n  async post(endpoint, data = {}, options = {}) {\n    Object.assign(options, this._getCommonOptions());\n    return axios.post(`${this.BASE_URL}/${endpoint}`, data, options).catch(error => this._handleHttpError(error));\n  }\n  async delete(endpoint, options = {}) {\n    Object.assign(options, this._getCommonOptions());\n    return axios.delete(`${this.BASE_URL}/${endpoint}`, options).catch(error => this._handleHttpError(error));\n  }\n  async patch(endpoint, data = {}, options = {}) {\n    Object.assign(options, this._getCommonOptions());\n    return axios.patch(`${this.BASE_URL}/${endpoint}`, data, options).catch(error => this._handleHttpError(error));\n  }\n  _handleHttpError(error) {\n    const {\n      statusCode\n    } = error.response.data;\n    if (statusCode !== 401) {\n      throw error;\n    } else {\n      return this._handle401();\n    }\n  }\n  _handle401() {\n    window.location.hash = '/signin';\n  }\n  _getCommonOptions() {\n    const token = this.loadToken();\n    return {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    };\n  }\n  get accessToken() {\n    return this._accessToken ? this._accessToken : this.loadToken();\n  }\n  saveToken(accessToken) {\n    this._accessToken = accessToken;\n    return localStorage.setItem('accessToken', accessToken);\n  }\n  loadToken() {\n    const token = localStorage.getItem('accessToken');\n    this._accessToken = token;\n    return token;\n  }\n  removeToken() {\n    localStorage.removeItem('accessToken');\n  }\n}","map":{"version":3,"names":["axios","BaseHttpService","constructor","routerStore","BASE_URL","process","env","REACT_APP_BASE_URL","_accessToken","get","endpoint","options","Object","assign","_getCommonOptions","catch","error","_handleHttpError","post","data","delete","patch","statusCode","response","_handle401","window","location","hash","token","loadToken","headers","Authorization","accessToken","saveToken","localStorage","setItem","getItem","removeToken","removeItem"],"sources":["/Users/wastardy/Documents/studying/client_task_flow/src/services/base-http.service.js"],"sourcesContent":["import axios from 'axios';\n\nexport default class BaseHttpService {\n  BASE_URL = process.env.REACT_APP_BASE_URL || 'http://localhost:3000';\n  _accessToken = null;\n\n  constructor(routerStore) {\n    this.routerStore = routerStore;\n  }\n\n  async get(endpoint, options = {}) {\n    Object.assign(options, this._getCommonOptions());\n    return axios.get(`${this.BASE_URL}/${endpoint}`, options)\n      .catch(error => this._handleHttpError(error));\n  }\n\n  async post(endpoint, data = {}, options = {}) {\n    Object.assign(options, this._getCommonOptions());\n    return axios.post(`${this.BASE_URL}/${endpoint}`, data, options)\n      .catch(error => this._handleHttpError(error));  \n  }\n\n  async delete(endpoint, options = {}) {\n    Object.assign(options, this._getCommonOptions());\n    return axios.delete(`${this.BASE_URL}/${endpoint}`, options)\n      .catch(error => this._handleHttpError(error));     \n  }\n\n  async patch(endpoint, data = {}, options = {}) {\n    Object.assign(options, this._getCommonOptions());\n    return axios.patch(`${this.BASE_URL}/${endpoint}`, data, options)\n      .catch(error => this._handleHttpError(error));   \n  }\n\n  _handleHttpError(error) {\n    const { statusCode } = error.response.data;\n\n    if (statusCode !== 401) {\n      throw error;\n    } else {\n      return this._handle401();\n    }\n  }\n\n  _handle401() {\n    window.location.hash = '/signin';\n  }\n\n  _getCommonOptions() {\n    const token = this.loadToken();\n\n    return {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    };\n  }\n\n  get accessToken() {\n    return this._accessToken ? this._accessToken : this.loadToken();\n  }\n\n  saveToken(accessToken) {\n    this._accessToken = accessToken;\n    return localStorage.setItem('accessToken', accessToken);\n  }\n\n  loadToken() {\n    const token = localStorage.getItem('accessToken');\n    this._accessToken = token;\n    return token;\n  }\n\n  removeToken() {\n    localStorage.removeItem('accessToken');\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}